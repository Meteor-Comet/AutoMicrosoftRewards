# Microsoft Rewards 自动化工具 - 故障排除指南

## 🚨 PyInstaller 打包问题解决方案

### 问题描述
在其他电脑上运行打包后的程序时出现以下错误：
```
Failed to execute script 'pyiboot01 bootstrap' due to unhandled exception: Bootloader did not set sys._pyinstaller _pyz!
Failed to obtain/convert traceback!
```

### 🔧 解决方案

#### 方案一：使用简单打包脚本（推荐）
```bash
python build_simple.py
```

**特点：**
- 使用目录模式（`--onedir`）而不是单文件模式
- 更稳定，兼容性更好
- 生成一个包含所有文件的目录

**使用说明：**
1. 运行 `python build_simple.py`
2. 将生成的 `dist/MicrosoftRewards/` 整个目录复制到目标机器
3. 双击 `MicrosoftRewards.exe` 运行程序

#### 方案二：使用稳定打包脚本
```bash
python build_exe_stable.py
```

**特点：**
- 提供多种打包策略
- 自动创建spec文件
- 更详细的错误处理

#### 方案三：手动解决

**步骤1：清理环境**
```bash
# 卸载并重新安装PyInstaller
pip uninstall pyinstaller
pip install pyinstaller>=5.0.0

# 清理构建目录
rmdir /s build
rmdir /s dist
rmdir /s __pycache__
```

**步骤2：使用基本命令打包**
```bash
pyinstaller --onedir --windowed --name=MicrosoftRewards gui_app.py
```

**步骤3：手动复制文件**
```bash
copy chromedriver.exe dist\MicrosoftRewards\
copy custom_search_terms.py dist\MicrosoftRewards\
copy account_manager.py dist\MicrosoftRewards\
```

### 🔍 常见原因分析

#### 1. Python环境问题
- **问题**: Python版本不兼容或环境污染
- **解决**: 使用干净的虚拟环境
```bash
python -m venv venv
venv\Scripts\activate
pip install -r requirements_gui.txt
```

#### 2. PyInstaller版本问题
- **问题**: PyInstaller版本过旧或损坏
- **解决**: 升级到最新版本
```bash
pip install --upgrade pyinstaller
```

#### 3. 杀毒软件干扰
- **问题**: 杀毒软件误报或阻止程序运行
- **解决**: 
  - 添加程序到杀毒软件白名单
  - 临时关闭实时保护
  - 以管理员身份运行

#### 4. 系统权限问题
- **问题**: 权限不足导致程序无法正常启动
- **解决**: 以管理员身份运行命令提示符

### 📋 打包前检查清单

- [ ] 确保所有必要文件存在：
  - `gui_app.py`
  - `chromedriver.exe`
  - `account_manager.py`
  - `custom_search_terms.py`（可选）

- [ ] 检查Python环境：
  - Python 3.6+
  - 已安装所有依赖包

- [ ] 清理构建目录：
  - 删除 `build/` 目录
  - 删除 `dist/` 目录
  - 删除 `__pycache__/` 目录

- [ ] 确保网络连接正常（下载依赖包需要）

### 🛠️ 调试技巧

#### 1. 启用控制台模式
如果GUI无法启动，可以临时启用控制台模式查看错误信息：
```bash
pyinstaller --onedir --console --name=MicrosoftRewards gui_app.py
```

#### 2. 查看详细日志
运行程序时查看控制台输出的详细错误信息。

#### 3. 检查文件完整性
确保打包后的程序包含所有必要文件：
- `MicrosoftRewards.exe`
- `chromedriver.exe`
- `account_manager.py`
- `custom_search_terms.py`

### 📞 获取帮助

如果以上方案都无法解决问题，请：

1. **收集错误信息**：
   - 完整的错误消息
   - 操作系统版本
   - Python版本
   - PyInstaller版本

2. **提供环境信息**：
   - 打包环境（操作系统、Python版本）
   - 运行环境（目标机器配置）

3. **提交问题**：
   - 在GitHub仓库提交Issue
   - 包含详细的错误信息和环境描述

### 🎯 最佳实践

1. **使用虚拟环境**：避免全局Python环境污染
2. **定期更新依赖**：保持PyInstaller和Selenium为最新版本
3. **测试兼容性**：在目标机器上测试打包后的程序
4. **备份源码**：保留原始Python脚本作为备用方案

### 📝 更新日志

- **v1.0**: 初始版本，基础故障排除指南
- **v1.1**: 添加PyInstaller打包问题解决方案
- **v1.2**: 增加调试技巧和最佳实践 