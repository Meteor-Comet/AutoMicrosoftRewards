# Microsoft Rewards GUI 版本使用说明

## 🎯 功能特点

### ✨ 图形化界面
- 🖥️ **现代化界面**: 使用tkinter创建的简洁美观的GUI
- 📱 **选项卡设计**: 分为登录管理、自动搜索、设置、运行日志四个模块
- 🎮 **一键操作**: 点击按钮即可执行相应功能
- 📊 **实时进度**: 显示搜索进度和状态信息

### 🔧 核心功能
- 🔐 **智能登录**: 自动检测登录状态，无需手动计时
- 🔍 **自动搜索**: 支持桌面端和移动端搜索
- 👤 **多账号管理**: 支持多个Microsoft账户的切换和管理
- ⚙️ **灵活配置**: 可自定义搜索参数和搜索词
- 📋 **详细日志**: 实时显示操作日志和错误信息

## 📁 文件结构

### 开发文件
- `gui_app.py`: 主GUI程序
- `build_exe.py`: 打包脚本
- `requirements_gui.txt`: GUI版本依赖

### 发布文件
- `MicrosoftRewards.exe`: 主程序（打包后）
- `chromedriver.exe`: Chrome浏览器驱动
- `custom_search_terms.py`: 自定义搜索词文件（可选）
- `accounts.json`: 账号配置文件（自动生成）
- `accounts/`: 账号数据目录（自动生成）

## 🚀 使用方法

### 1. 开发环境运行

```bash
# 安装依赖
pip install -r requirements_gui.txt

# 运行GUI程序
python gui_app.py
```

### 2. 打包成exe

```bash
# 运行打包脚本
python build_exe.py
```

打包完成后，在`dist`目录下会生成：
- `MicrosoftRewards.exe`: 主程序
- `chromedriver.exe`: 浏览器驱动
- `custom_search_terms.py`: 自定义搜索词文件

### 3. 发布使用

将`dist`目录下的所有文件复制到目标机器，双击`MicrosoftRewards.exe`即可运行。

## 🎮 界面说明

### 👤 账号管理选项卡

#### 功能说明
- **账号列表**: 显示所有已添加的账号及其状态
- **➕ 添加账号**: 添加新的Microsoft账户
- **🗑️ 删除账号**: 删除选中的账号及其数据
- **💾 保存Cookies**: 将当前cookies保存到当前账号

#### 账号切换方式
1. **直接点击切换**: 点击账号列表中的"🔄 切换"按钮直接切换
2. **双击切换**: 双击账号名称快速切换
3. **选中后切换**: 选中账号后点击"切换账号"按钮

#### 使用步骤
1. 点击"➕ 添加账号"创建新账号
2. 输入账号名称（必填）和邮箱、描述（可选）
3. 使用任意一种方式切换到目标账号
4. 登录后cookies会自动保存到当前账号
5. 可以随时切换不同账号进行搜索

#### 账号列表说明
- **账号名称**: 显示账号的标识名称
- **状态**: 显示账号的cookies状态（有效/无效/过期）
- **操作**: 显示"🔄 切换"按钮或"当前账号"标识

#### Cookies过期处理
当cookies过期时，程序会智能提示用户选择：
- **重新登录**: 为当前账号重新获取cookies
- **切换账号**: 切换到其他已添加的账号
- **添加新账号**: 创建新账号并立即登录

### 🔐 登录管理选项卡

#### 功能说明
- **开始登录**: 启动浏览器并访问必应，等待用户手动登录
- **停止登录**: 停止登录检测过程
- **重新登录**: 为当前账号重新获取cookies
- **登录状态**: 显示当前登录状态和进度

#### 使用步骤
1. 点击"🔐 开始登录"按钮
2. 程序会自动打开浏览器并访问必应
3. 在浏览器中手动登录你的Microsoft账户
4. 程序会自动检测登录状态并保存cookies
5. 登录成功后可以关闭浏览器

### 🔍 自动搜索选项卡

#### 搜索选项
- **🖥️ 桌面端搜索**: 仅执行桌面端搜索（30次）
- **📱 移动端搜索**: 仅执行移动端搜索（20次）
- **🔄 完整搜索**: 执行桌面端+移动端搜索
- **🎯 积分任务**: 自动点击积分侧栏中的任务获得积分

#### 搜索参数
- **搜索间隔**: 每次搜索之间的等待时间（默认8秒）
- **桌面端搜索次数**: 桌面端搜索的次数（默认30次）
- **移动端搜索次数**: 移动端搜索的次数（默认20次）

#### 操作按钮
- **🚀 开始搜索**: 开始执行搜索任务
- **⏹️ 停止搜索**: 停止当前搜索任务

#### 进度显示
- **搜索进度**: 显示当前搜索进度和状态
- **进度条**: 可视化显示搜索进度

#### 积分任务说明
- **功能**: 自动点击必应首页积分侧栏中的任务获得积分
- **工作流程**: 
  1. 访问必应首页并加载cookies
  2. 查找并点击积分侧栏
  3. 尝试多种方式查找积分任务：
     - 直接访问rewards页面
     - 在必应首页查找积分侧栏
     - 查找并切换到包含积分任务的iframe
  4. 识别可获得的积分任务（未完成的任务）
  5. 逐个点击任务，自动关闭新打开的标签页
  6. 跳过已完成的任务（有✓标记或标记为Completed的任务）
- **任务识别**: 
  - 主要通过`div.point_cont`容器识别积分任务
  - 从`aria-label`属性提取任务名称
  - 通过多种方式判断完成状态：
    - `svg.checkMark`图标
    - 父元素包含`complete`类
    - `aria-label`中包含"Completed"或"添加到帐户"
- **积分显示**: 显示每个任务的积分数量（如10积分）
- **完成状态**: 已完成的任务会显示✓标记或"Completed"状态
- **注意事项**: 
  - 需要先登录Microsoft账户
  - 任务数量取决于当日可获得的积分任务
  - 程序会自动处理新窗口的打开和关闭
  - 程序会自动跳过已失效或不可点击的任务元素
- **错误处理**: 
  - 程序包含完善的错误处理机制
  - 会自动跳过失效的元素和不可点击的任务
  - 自动滚动到任务位置确保元素可见
  - 等待元素加载和可交互状态
  - 自动管理iframe状态，确保任务处理过程中正确切换
  - 提供详细的日志信息便于调试
- **调试工具**: 如果遇到问题，可以运行 `python test_rewards.py` 来调试积分任务功能
  - 测试脚本只分析任务结构，不执行点击操作
  - 用于验证任务识别、积分显示、完成状态等是否正确
  - 帮助诊断iframe加载、元素定位等问题

### ⚙️ 设置选项卡

#### 文件检查
- **🔍 检查必要文件**: 检查chromedriver.exe、cookies.txt等必要文件
- **文件状态**: 显示各文件的存在状态

#### Cookies管理
- **🔍 验证Cookies**: 验证已保存的cookies是否有效
- **🗑️ 删除Cookies**: 删除已保存的cookies文件
- **Cookies状态**: 显示cookies的有效性

#### 账号管理
- **🔄 刷新账号列表**: 刷新账号列表显示
- **🔍 验证所有Cookies**: 验证所有账号的cookies有效性

#### 搜索词管理
- **✏️ 编辑搜索词**: 打开自定义搜索词文件进行编辑

#### ChromeDriver更新
- **🔍 检查ChromeDriver更新**: 检查当前ChromeDriver版本和最新ChromeDriver版本
- **⬇️ 更新ChromeDriver**: 自动下载并更新ChromeDriver文件
- **更新状态**: 显示当前版本和更新状态

**更新功能特点**：
- 自动检测系统类型（Windows/Linux/macOS）
- 获取当前ChromeDriver版本
- 从官方API获取最新ChromeDriver版本
- 自动下载并替换ChromeDriver文件
- 支持版本回滚（更新失败时自动恢复）
- 更新完成后建议重启程序

### 📋 运行日志选项卡

#### 日志功能
- **实时日志**: 显示程序运行过程中的所有操作日志
- **日志级别**: 不同颜色显示不同级别的日志（成功、错误、警告、信息）
- **🗑️ 清空日志**: 清空当前日志内容
- **💾 保存日志**: 将日志保存到文件

## ⚙️ 配置说明

### 多账号管理

#### 账号文件结构
- `accounts.json`: 账号配置文件，包含所有账号信息
- `accounts/`: 账号数据目录，存储各账号的cookies文件
- `cookies_账号名.txt`: 每个账号的cookies文件

#### 账号操作
1. **添加账号**: 在账号管理选项卡中点击"➕ 添加账号"
2. **切换账号**: 
   - 直接点击账号列表中的"🔄 切换"按钮
   - 双击账号名称快速切换
   - 选中账号后点击"切换账号"按钮
3. **删除账号**: 选择账号后点击"🗑️ 删除账号"
4. **保存cookies**: 登录后cookies会自动保存到当前账号

### 自定义搜索词

编辑`custom_search_terms.py`文件来自定义搜索词：

```python
CUSTOM_SEARCH_TERMS = [
    "你的搜索词1",
    "你的搜索词2",
    "你的搜索词3",
    # ... 更多搜索词
]
```

### 搜索参数调整

在搜索选项卡中可以调整：
- **搜索间隔**: 建议8-15秒，避免过于频繁
- **搜索次数**: 根据Microsoft Rewards的要求调整
- **搜索类型**: 根据需要选择桌面端、移动端或完整搜索

## 🛠️ 故障排除

### 常见问题

1. **程序无法启动**
   - 确保chromedriver.exe与exe文件在同一目录
   - 检查Chrome浏览器是否已安装
   - 确保ChromeDriver版本为最新版本

2. **登录检测失败**
   - 确保在必应首页进行登录
   - 检查网络连接是否正常
   - 尝试刷新页面后重新登录

3. **搜索失败**
   - 检查cookies是否有效
   - 确保网络连接稳定
   - 检查搜索参数设置

4. **程序卡死**
   - 点击"停止"按钮停止当前任务
   - 关闭程序重新启动
   - 检查系统资源使用情况

### 日志分析

程序会在日志选项卡中显示详细的操作信息：
- ✅ **成功操作**: 绿色显示
- ❌ **错误信息**: 红色显示
- ⚠️ **警告信息**: 橙色显示
- ℹ️ **一般信息**: 蓝色显示

## 📝 注意事项

1. **首次使用**: 必须先登录获取cookies
2. **网络要求**: 确保网络连接稳定
3. **浏览器要求**: 需要安装Chrome浏览器
4. **权限要求**: 程序需要访问网络和文件系统
5. **使用频率**: 避免过于频繁的搜索，遵守Microsoft Rewards的使用条款

## 🎉 更新日志

### v1.1
- 添加多账号管理功能
- 支持账号切换和cookies管理
- 优化界面布局和用户体验
- 添加账号验证功能
- 智能处理cookies过期情况
- 提供重新登录和账号切换选项

### v1.0
- 创建图形化界面
- 实现登录管理功能
- 实现自动搜索功能
- 添加设置和日志功能
- 支持exe打包

## 📄 免责声明

本工具仅供学习和研究使用，请遵守Microsoft Rewards的使用条款。使用者需自行承担使用风险。 