# Microsoft Rewards GUI 版本使用说明

## 🎯 功能特点

### ✨ 图形化界面
- 🖥️ **现代化界面**: 使用tkinter创建的简洁美观的GUI
- 📱 **选项卡设计**: 分为登录管理、自动搜索、设置、运行日志四个模块
- 🎮 **一键操作**: 点击按钮即可执行相应功能
- 📊 **实时进度**: 显示搜索进度和状态信息

### 🔧 核心功能
- 🔐 **智能登录**: 自动检测登录状态，无需手动计时
- 🔍 **自动搜索**: 支持桌面端和移动端搜索
- 👤 **多账号管理**: 支持多个Microsoft账户的切换和管理
- ⚙️ **灵活配置**: 可自定义搜索参数和搜索词
- 📋 **详细日志**: 实时显示操作日志和错误信息

## 📁 文件结构

### 开发文件
- `gui_app.py`: 主GUI程序
- `build_exe.py`: 打包脚本
- `requirements_gui.txt`: GUI版本依赖

### 发布文件
- `MicrosoftRewards.exe`: 主程序（打包后）
- `chromedriver.exe`: Chrome浏览器驱动
- `custom_search_terms.py`: 自定义搜索词文件（可选）
- `accounts.json`: 账号配置文件（自动生成）
- `accounts/`: 账号数据目录（自动生成）

## 🚀 使用方法

### 1. 开发环境运行

```bash
# 安装依赖
pip install -r requirements_gui.txt

# 运行GUI程序
python gui_app.py
```

### 2. 打包成exe

```bash
# 运行打包脚本
python build_exe.py
```

打包完成后，在`dist`目录下会生成：
- `MicrosoftRewards.exe`: 主程序
- `chromedriver.exe`: 浏览器驱动
- `custom_search_terms.py`: 自定义搜索词文件

### 3. 发布使用

将`dist`目录下的所有文件复制到目标机器，双击`MicrosoftRewards.exe`即可运行。

## 🎮 界面说明

### 👤 账号管理选项卡

#### 功能说明
- **账号列表**: 显示所有已添加的账号及其状态
- **➕ 添加账号**: 添加新的Microsoft账户
- **🗑️ 删除账号**: 删除选中的账号及其数据
- **🔄 切换账号**: 切换到选中的账号
- **💾 保存Cookies**: 将当前cookies保存到当前账号

#### 使用步骤
1. 点击"➕ 添加账号"创建新账号
2. 输入账号名称（必填）和邮箱、描述（可选）
3. 选择账号后点击"🔄 切换账号"切换到该账号
4. 登录后cookies会自动保存到当前账号
5. 可以随时切换不同账号进行搜索

#### Cookies过期处理
当cookies过期时，程序会智能提示用户选择：
- **重新登录**: 为当前账号重新获取cookies
- **切换账号**: 切换到其他已添加的账号
- **添加新账号**: 创建新账号并立即登录

### 🔐 登录管理选项卡

#### 功能说明
- **开始登录**: 启动浏览器并访问必应，等待用户手动登录
- **停止登录**: 停止登录检测过程
- **重新登录**: 为当前账号重新获取cookies
- **登录状态**: 显示当前登录状态和进度

#### 使用步骤
1. 点击"🔐 开始登录"按钮
2. 程序会自动打开浏览器并访问必应
3. 在浏览器中手动登录你的Microsoft账户
4. 程序会自动检测登录状态并保存cookies
5. 登录成功后可以关闭浏览器

### 🔍 自动搜索选项卡

#### 搜索选项
- **🖥️ 桌面端搜索**: 仅执行桌面端搜索（30次）
- **📱 移动端搜索**: 仅执行移动端搜索（20次）
- **🔄 完整搜索**: 执行桌面端+移动端搜索

#### 搜索参数
- **搜索间隔**: 每次搜索之间的等待时间（默认8秒）
- **桌面端搜索次数**: 桌面端搜索的次数（默认30次）
- **移动端搜索次数**: 移动端搜索的次数（默认20次）

#### 操作按钮
- **🚀 开始搜索**: 开始执行搜索任务
- **⏹️ 停止搜索**: 停止当前搜索任务

#### 进度显示
- **搜索进度**: 显示当前搜索进度和状态
- **进度条**: 可视化显示搜索进度

### ⚙️ 设置选项卡

#### 文件检查
- **🔍 检查必要文件**: 检查chromedriver.exe、cookies.txt等必要文件
- **文件状态**: 显示各文件的存在状态

#### Cookies管理
- **🔍 验证Cookies**: 验证已保存的cookies是否有效
- **🗑️ 删除Cookies**: 删除已保存的cookies文件
- **Cookies状态**: 显示cookies的有效性

#### 账号管理
- **🔄 刷新账号列表**: 刷新账号列表显示
- **🔍 验证所有Cookies**: 验证所有账号的cookies有效性

#### 搜索词管理
- **✏️ 编辑搜索词**: 打开自定义搜索词文件进行编辑

### 📋 运行日志选项卡

#### 日志功能
- **实时日志**: 显示程序运行过程中的所有操作日志
- **日志级别**: 不同颜色显示不同级别的日志（成功、错误、警告、信息）
- **🗑️ 清空日志**: 清空当前日志内容
- **💾 保存日志**: 将日志保存到文件

## ⚙️ 配置说明

### 多账号管理

#### 账号文件结构
- `accounts.json`: 账号配置文件，包含所有账号信息
- `accounts/`: 账号数据目录，存储各账号的cookies文件
- `cookies_账号名.txt`: 每个账号的cookies文件

#### 账号操作
1. **添加账号**: 在账号管理选项卡中点击"➕ 添加账号"
2. **切换账号**: 选择账号后点击"🔄 切换账号"
3. **删除账号**: 选择账号后点击"🗑️ 删除账号"
4. **保存cookies**: 登录后cookies会自动保存到当前账号

### 自定义搜索词

编辑`custom_search_terms.py`文件来自定义搜索词：

```python
CUSTOM_SEARCH_TERMS = [
    "你的搜索词1",
    "你的搜索词2",
    "你的搜索词3",
    # ... 更多搜索词
]
```

### 搜索参数调整

在搜索选项卡中可以调整：
- **搜索间隔**: 建议8-15秒，避免过于频繁
- **搜索次数**: 根据Microsoft Rewards的要求调整
- **搜索类型**: 根据需要选择桌面端、移动端或完整搜索

## 🛠️ 故障排除

### 常见问题

1. **程序无法启动**
   - 确保chromedriver.exe与exe文件在同一目录
   - 检查Chrome浏览器是否已安装
   - 确保ChromeDriver版本与Chrome浏览器版本匹配

2. **登录检测失败**
   - 确保在必应首页进行登录
   - 检查网络连接是否正常
   - 尝试刷新页面后重新登录

3. **搜索失败**
   - 检查cookies是否有效
   - 确保网络连接稳定
   - 检查搜索参数设置

4. **程序卡死**
   - 点击"停止"按钮停止当前任务
   - 关闭程序重新启动
   - 检查系统资源使用情况

### 日志分析

程序会在日志选项卡中显示详细的操作信息：
- ✅ **成功操作**: 绿色显示
- ❌ **错误信息**: 红色显示
- ⚠️ **警告信息**: 橙色显示
- ℹ️ **一般信息**: 蓝色显示

## 📝 注意事项

1. **首次使用**: 必须先登录获取cookies
2. **网络要求**: 确保网络连接稳定
3. **浏览器要求**: 需要安装Chrome浏览器
4. **权限要求**: 程序需要访问网络和文件系统
5. **使用频率**: 避免过于频繁的搜索，遵守Microsoft Rewards的使用条款

## 🎉 更新日志

### v1.1
- 添加多账号管理功能
- 支持账号切换和cookies管理
- 优化界面布局和用户体验
- 添加账号验证功能
- 智能处理cookies过期情况
- 提供重新登录和账号切换选项

### v1.0
- 创建图形化界面
- 实现登录管理功能
- 实现自动搜索功能
- 添加设置和日志功能
- 支持exe打包

## 📄 免责声明

本工具仅供学习和研究使用，请遵守Microsoft Rewards的使用条款。使用者需自行承担使用风险。 