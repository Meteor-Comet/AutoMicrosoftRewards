# Microsoft Rewards 自动化工具

一个用于自动化Microsoft Rewards搜索和积分任务的Python工具，支持图形化界面。

## ✨ 主要功能

### 🔍 自动搜索
- **桌面端搜索**: 自动执行桌面端Bing搜索
- **移动端搜索**: 自动执行移动端Bing搜索  
- **完整搜索**: 同时执行桌面端和移动端搜索
- **积分任务**: 自动点击Microsoft Rewards侧栏任务
- **全部账号任务**: 为所有保存的账号自动执行完整任务流程

### 👥 多账号管理
- **账号切换**: 支持多个Microsoft账号的切换
- **Cookie管理**: 自动保存和加载每个账号的cookies
- **账号验证**: 验证cookies是否有效
- **批量操作**: 为所有账号批量执行任务

### ⚙️ 设置管理
- **搜索参数**: 可自定义搜索间隔和次数
- **设置保存**: 自动保存搜索设置，下次打开时自动恢复
- **窗口位置**: 记住窗口位置和大小
- **账号记忆**: 记住上次使用的账号

### 🔧 系统工具
- **ChromeDriver更新**: 自动检查并更新ChromeDriver版本
- **手动下载**: 提供手动下载链接和详细说明
- **文件检查**: 检查必要文件是否存在
- **Cookie验证**: 验证cookies有效性

## 🚀 快速开始

### 系统要求
- Windows 10/11
- Python 3.7+
- Google Chrome浏览器
- ChromeDriver (程序会自动下载)

### 安装步骤

1. **下载程序**
   ```
   下载 gui_app.py 和所有相关文件
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements_gui.txt
   ```

3. **运行程序**
   ```bash
   python gui_app.py
   ```

## 📖 使用说明

### 首次使用

1. **登录账号**
   - 点击"🔑 登录"选项卡
   - 点击"🚀 开始登录"按钮
   - 在打开的浏览器中完成Microsoft账号登录
   - 登录成功后程序会自动保存cookies

2. **配置搜索参数**
   - 在"🔍 自动搜索"选项卡中设置搜索参数
   - 搜索间隔: 建议8-10秒
   - 桌面端搜索次数: 默认30次
   - 移动端搜索次数: 默认20次
   - 点击"💾 保存设置"保存配置

3. **开始搜索**
   - 选择搜索类型
   - 点击"🚀 开始搜索"按钮
   - 程序会自动执行搜索任务

### 多账号使用

1. **添加账号**
   - 点击"👥 账号管理"选项卡
   - 点击"➕ 添加账号"按钮
   - 输入账号名称并登录

2. **切换账号**
   - 在账号列表中双击账号名称
   - 或点击"🔄 切换账号"按钮选择

3. **批量任务**
   - 选择"👥 全部账号任务"
   - 程序会依次为所有账号执行完整任务

### 设置管理

程序会自动保存以下设置：
- **搜索参数**: 间隔时间、搜索次数、搜索类型
- **窗口位置**: 程序窗口的位置和大小
- **当前账号**: 上次使用的账号
- **自动保存**: 登录时自动保存cookies

设置保存在 `config.json` 文件中，程序启动时会自动加载。

### ChromeDriver更新

1. **自动更新**
   - 在"⚙️ 设置"选项卡中点击"🔄 检查更新"
   - 如果发现新版本，点击"⬇️ 更新ChromeDriver"

2. **手动更新**
   - 如果自动更新失败，会显示手动下载对话框
   - 点击"复制下载链接"获取下载地址
   - 下载并解压到程序目录

## 📁 文件说明

### 核心文件
- `gui_app.py`: 主程序文件
- `config_manager.py`: 配置管理模块
- `account_manager.py`: 账号管理模块
- `chromedriver_updater.py`: ChromeDriver更新模块

### 配置文件
- `config.json`: 程序配置文件（自动生成）
- `cookies.txt`: 当前账号的cookies文件
- `accounts/`: 账号cookies存储目录

### 依赖文件
- `requirements_gui.txt`: GUI版本依赖列表
- `custom_search_terms.py`: 自定义搜索词

## 🔧 高级功能

### 自定义搜索词
编辑 `custom_search_terms.py` 文件来自定义搜索词：
```python
RANDOM_SEARCH_TERMS = [
    "Python编程",
    "人工智能",
    "机器学习",
    # 添加更多搜索词...
]
```

### 命令行模式
程序也支持命令行模式：
```bash
python search.py  # 执行搜索
python get_cookie.py  # 获取cookies
```

## 🛠️ 故障排除

### 常见问题

1. **ChromeDriver版本不匹配**
   - 使用程序内置的更新功能
   - 或手动下载对应版本的ChromeDriver

2. **Cookies过期**
   - 程序会自动检测并提示重新登录
   - 或手动删除cookies文件重新登录

3. **搜索失败**
   - 检查网络连接
   - 确认cookies是否有效
   - 尝试增加搜索间隔时间

4. **程序无法启动**
   - 检查Python版本（需要3.7+）
   - 确认所有依赖已安装
   - 检查ChromeDriver是否存在

### 日志查看
程序运行日志会显示在"📋 日志"选项卡中，包含详细的操作信息和错误提示。

## 📝 更新日志

### v2.0.0
- ✅ 新增图形化界面
- ✅ 新增多账号管理功能
- ✅ 新增ChromeDriver自动更新
- ✅ 新增设置保存和恢复功能
- ✅ 新增积分任务自动化
- ✅ 新增全部账号批量任务

### v1.0.0
- ✅ 基础搜索功能
- ✅ Cookie管理
- ✅ 命令行界面

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目仅供学习和个人使用，请遵守Microsoft Rewards的使用条款。